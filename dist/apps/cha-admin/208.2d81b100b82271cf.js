"use strict";(self.webpackChunkcha_admin=self.webpackChunkcha_admin||[]).push([[208],{5208:(Ht,F,o)=>{o.r(F),o.d(F,{ChaAdminDraftMgmtTableModule:()=>Ut});var f=o(6895),p=o(433),d=o(8776),r=o(9653),C=o(644),_=o(8235),h=o(2336),I=o(1740),M=o(5593),x=o(3214),B=o(1624),H=o(2675),S=o(5199),v=o(8417),k=o(4086),z=o(1365),$=o(6129),D=o(4004),Z=o(262),w=o(9646),K=o(8505);const u="[DRAFT MGMT TABLE]",s={getDraftTable:(0,r.PH)(`${u} Get Draft Table`),getDraftTableSuccess:(0,r.PH)(`${u} Get Draft Table Success`,(0,r.Ky)()),editDraftPick:(0,r.PH)(`${u} Edit Draft Pick`,(0,r.Ky)()),editDraftPickSuccess:(0,r.PH)(`${u} Edit Draft Pick Success`,(0,r.Ky)()),error:(0,r.PH)(`${u} Error`)},P={draftTableItems:[],loading:!1,loaded:!1,saving:!1,saved:!1},tt=(0,r.Lq)(P,(0,r.on)(s.getDraftTable,e=>({...e,loading:!0,loaded:!1})),(0,r.on)(s.editDraftPick,e=>({...e,saving:!0,saved:!1})),(0,r.on)(s.getDraftTableSuccess,(e,n)=>({...e,draftTableItems:n.draftTableItems,loading:!1,loaded:!0})),(0,r.on)(s.editDraftPickSuccess,(e,n)=>({...e,saving:!1,saved:!0})),(0,r.on)(s.error,e=>P));function et(e,n){return tt(e,n)}const g=(0,r.ZF)("draft-mgmt-table"),it=(0,r.P1)(g,e=>e.loading),b={selectLoaded:(0,r.P1)(g,e=>e.loaded),selectLoading:it,selectSaving:(0,r.P1)(g,e=>e.saving),selectSaved:(0,r.P1)(g,e=>e.saved),selectDraftTableItems:(0,r.P1)(g,e=>e.draftTableItems)};var t=o(4650);let T=(()=>{class e{constructor(a){this.store=a,this.isLoading$=this.store.select(b.selectLoading),this.isLoaded$=this.store.select(b.selectLoaded),this.isSaving$=this.store.select(b.selectSaving),this.isSaved$=this.store.select(b.selectSaved),this.draftTableItems$=this.store.select(b.selectDraftTableItems)}getDraftTable(){this.store.dispatch(s.getDraftTable())}editPick(a){this.store.dispatch(s.editDraftPick({draftTableItem:a}))}}return e.\u0275fac=function(a){return new(a||e)(t.LFG(r.yh))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac}),e})();var ft=o(529);let pt=(()=>{class e{constructor(a,l){this._http=a,this.apiUrl=l}getDraftTable(a){return this._http.get(`${this.apiUrl}/draft-table/${a}`).pipe((0,D.U)(l=>l))}edit(a){return this._http.put(`${this.apiUrl}/draft-table/${a.id}`,a).pipe((0,D.U)(l=>l))}}return e.\u0275fac=function(a){return new(a||e)(t.LFG(ft.eN),t.LFG("apiUrl"))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var A=o(805);let R=(()=>{class e{constructor(a,l,i,m,Yt){this.actions$=a,this.draftMgmtTableFacade=l,this.draftMgmtTableService=i,this.leagueDataFacade=m,this.messageService=Yt,this.getDraftTable$=(0,d.GW)(()=>this.actions$.pipe((0,d.l4)(s.getDraftTable),(0,k.g)(500),(0,z.M)(this.leagueDataFacade.leagueData$),(0,$.z)(([Y,y])=>this.draftMgmtTableService.getDraftTable(y.current_draft_year).pipe((0,D.U)(Bt=>s.getDraftTableSuccess({draftTableItems:Bt})),(0,Z.K)(()=>(0,w.of)(s.error())))))),this.editDraftTable$=(0,d.GW)(()=>this.actions$.pipe((0,d.l4)(s.editDraftPick),(0,$.z)(Y=>this.draftMgmtTableService.edit(Y.draftTableItem).pipe((0,D.U)(y=>s.editDraftPickSuccess({draftTableItem:y})),(0,Z.K)(()=>(0,w.of)(s.error())))))),this.editPickSuccess$=(0,d.GW)(()=>this.actions$.pipe((0,d.l4)(s.editDraftPickSuccess),(0,K.b)(()=>{this.messageService.add({severity:"success",summary:"Edit Draft Row",detail:"Draft Row has been updated"}),this.draftMgmtTableFacade.getDraftTable()})),{dispatch:!1})}}return e.\u0275fac=function(a){return new(a||e)(t.LFG(d.eX),t.LFG(T),t.LFG(pt),t.LFG(v.Ib),t.LFG(A.ez))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac}),e})();var J=o(1779),L=o(590),ut=o(4268),O=o(1889),Q=o(4984),E=o(655),G=o(9933),gt=o(9300),N=o(4057);let U=(()=>{class e{constructor(a){this.leagueDataFacade=a,this.form=new p.nJ({}),this.model={},this.options={},this.teamOptions$=this.leagueDataFacade.leagueTeamsOptionsById$}ngOnInit(){this.draftTableItem&&this.patchForm(),this.createFields()}createFields(){this.fields=[{fieldGroupClassName:"w-full flex flex-wrap column-gap-2 row-gap-3",fieldGroup:[this.teamField()]},{fieldGroupClassName:"w-full flex flex-wrap column-gap-2 row-gap-2",fieldGroup:[this.roundOneField(),this.roundTwoField(),this.roundThreeField(),this.roundFourField(),this.roundFiveField()]}]}patchForm(){this.model={team:`${this.draftTableItem?.team_id.city} ${this.draftTableItem?.team_id.nickname}`,round_one:this.draftTableItem?.round_one,round_two:this.draftTableItem?.round_two,round_three:this.draftTableItem?.round_three,round_four:this.draftTableItem?.round_four,round_five:this.draftTableItem?.round_five}}teamField(){return{key:"team",className:"w-full md:w-4",type:"text-input",templateOptions:{label:"Team",readonly:!0}}}roundOneField(){return{key:"round_one",className:"w-full md:w-2",type:"single-select",templateOptions:{label:"Round One",placeholder:"Select Team",required:!0,options:this.teamOptions$,valueProp:"value",labelProp:"label"},validation:{messages:{required:()=>"Team is required"}}}}roundTwoField(){return{key:"round_two",className:"w-full md:w-2",type:"single-select",templateOptions:{label:"Round Two",placeholder:"Select Team",required:!0,options:this.teamOptions$,valueProp:"value",labelProp:"label"},validation:{messages:{required:()=>"Team is required"}}}}roundThreeField(){return{key:"round_three",className:"w-full md:w-2",type:"single-select",templateOptions:{label:"Round Three",placeholder:"Select Team",required:!0,options:this.teamOptions$,valueProp:"value",labelProp:"label"},validation:{messages:{required:()=>"Team is required"}}}}roundFourField(){return{key:"round_four",className:"w-full md:w-2",type:"single-select",templateOptions:{label:"Round Four",placeholder:"Select Team",required:!0,options:this.teamOptions$,valueProp:"value",labelProp:"label"},validation:{messages:{required:()=>"Team is required"}}}}roundFiveField(){return{key:"round_five",className:"w-full md:w-2",type:"single-select",templateOptions:{label:"Round Five",placeholder:"Select Team",required:!0,options:this.teamOptions$,valueProp:"value",labelProp:"label"},validation:{messages:{required:()=>"Team is required"}}}}}return e.\u0275fac=function(a){return new(a||e)(t.Y36(v.Ib))},e.\u0275cmp=t.Xpm({type:e,selectors:[["cha-admin-draft-mgmt-table-edit-form"]],inputs:{draftTableItem:"draftTableItem"},decls:2,vars:5,consts:[[1,"w-full",3,"formGroup"],[3,"model","fields","options","form"]],template:function(a,l){1&a&&(t.TgZ(0,"form",0),t._UZ(1,"formly-form",1),t.qZA()),2&a&&(t.Q6J("formGroup",l.form),t.xp6(1),t.Q6J("model",l.model)("fields",l.fields)("options",l.options)("form",l.form))},dependencies:[p._Y,p.JL,p.sg,N.T7],encapsulation:2,changeDetection:0}),e})();var bt=o(3186),Tt=o(1185);function ht(e,n){if(1&e&&(t.TgZ(0,"perfect-scrollbar"),t._UZ(1,"cha-admin-draft-mgmt-table-edit-form",8),t.qZA()),2&e){const a=t.oxw();t.Akn(a.panelStyle),t.xp6(1),t.Q6J("draftTableItem",a.draftTableItem)}}function vt(e,n){if(1&e&&t._UZ(0,"cha-admin-draft-mgmt-table-edit-form",8),2&e){const a=t.oxw();t.Q6J("draftTableItem",a.draftTableItem)}}let c=class{constructor(n){this.draftMgmtTableFacade=n,this.closeSidebar=new t.vpe,this.panelStyle={width:"100%",height:"65vh"}}onCancel(){this.closeSidebar.emit(!0)}onSave(){const n={...this.draftTableFormRef?.form.value,id:this.draftTableItem?.id};this.draftMgmtTableFacade.editPick(n),this.draftMgmtTableFacade.isSaving$.pipe((0,G.t)(this),(0,gt.h)(a=>!a)).subscribe(()=>{this.closeSidebar.emit(!0)})}};c.\u0275fac=function(n){return new(n||c)(t.Y36(T))},c.\u0275cmp=t.Xpm({type:c,selectors:[["cha-admin-draft-mgmt-table-edit"]],viewQuery:function(n,a){if(1&n&&t.Gf(U,5),2&n){let l;t.iGM(l=t.CRH())&&(a.draftTableFormRef=l.first)}},inputs:{draftTableItem:"draftTableItem",isMobile:"isMobile"},outputs:{closeSidebar:"closeSidebar"},decls:11,vars:4,consts:[[2,"background-color","var(--background-100)"],[1,"text-lg","font-light","text-center"],[3,"style",4,"ngIf"],[3,"draftTableItem",4,"ngIf"],[1,"flex","justify-content-between"],[1,"flex","column-gap-1"],["pButton","","pRipple","","type","button",1,"p-button-raised",3,"label","disabled","click"],["pButton","","pRipple","","type","button","label","Cancel",1,"p-button-raised","p-button-warning",3,"click"],[3,"draftTableItem"]],template:function(n,a){1&n&&(t.TgZ(0,"blade-card",0)(1,"blade-card-header",1),t._uU(2," Edit Draft Row "),t.qZA(),t.TgZ(3,"blade-card-body"),t.YNc(4,ht,2,3,"perfect-scrollbar",2),t.YNc(5,vt,1,1,"cha-admin-draft-mgmt-table-edit-form",3),t.qZA(),t.TgZ(6,"blade-card-footer")(7,"div",4)(8,"div",5)(9,"button",6),t.NdJ("click",function(){return a.onSave()}),t.qZA(),t.TgZ(10,"button",7),t.NdJ("click",function(){return a.onCancel()}),t.qZA()()()()()),2&n&&(t.xp6(4),t.Q6J("ngIf",a.isMobile),t.xp6(1),t.Q6J("ngIf",!a.isMobile),t.xp6(4),t.Q6J("label","Save Draft Row")("disabled",(null==a.draftTableFormRef||null==a.draftTableFormRef.form?null:a.draftTableFormRef.form.invalid)||!(null!=a.draftTableFormRef&&null!=a.draftTableFormRef.form&&a.draftTableFormRef.form.dirty)))},dependencies:[f.O5,C.Vv,M.Hq,O.A,Q.y,bt.x,Tt.n,U],encapsulation:2,changeDetection:0}),c=(0,E.gn)([(0,G.c)(),(0,E.w6)("design:paramtypes",[T])],c);const Dt=["dt"];function Mt(e,n){if(1&e){const a=t.EpF();t.TgZ(0,"div",6)(1,"span",7),t._UZ(2,"i",8),t.TgZ(3,"input",9),t.NdJ("input",function(i){t.CHM(a);const m=t.oxw();return t.KtG(m.applyFilterGlobal(i,"contains"))}),t.qZA()()()}}function yt(e,n){if(1&e&&(t.TgZ(0,"th",11),t._uU(1),t._UZ(2,"p-sortIcon",12),t.qZA()),2&e){const a=n.$implicit;t.Q6J("pSortableColumn",a.field),t.xp6(1),t.hij(" ",a.header," "),t.xp6(1),t.Q6J("field",a.field)}}function Ft(e,n){if(1&e&&(t.TgZ(0,"tr"),t.YNc(1,yt,3,3,"th",10),t.qZA()),2&e){const a=t.oxw();t.xp6(1),t.Q6J("ngForOf",a.tableColumns)}}function Ct(e,n){if(1&e&&(t.ynx(0),t._uU(1),t.BQk()),2&e){const a=t.oxw().$implicit,l=t.oxw().$implicit;t.xp6(1),t.hij(" ",l[a.field]," ")}}function _t(e,n){if(1&e&&(t.ynx(0),t._UZ(1,"img",17),t.BQk()),2&e){const a=t.oxw().$implicit,l=t.oxw().$implicit,i=t.oxw();t.xp6(1),t.Q6J("src",i.getLogo(l[a.field]),t.LSH)}}function It(e,n){if(1&e){const a=t.EpF();t.ynx(0),t.TgZ(1,"button",18),t.NdJ("click",function(){t.CHM(a);const i=t.oxw(2).$implicit,m=t.oxw();return t.KtG(m.onClick(i))}),t.qZA(),t.BQk()}}function xt(e,n){if(1&e&&(t.TgZ(0,"td")(1,"span",14),t._uU(2),t.qZA(),t.TgZ(3,"div",15),t.YNc(4,Ct,2,1,"ng-container",16),t.YNc(5,_t,2,1,"ng-container",16),t.YNc(6,It,2,0,"ng-container",16),t.qZA()()),2&e){const a=n.$implicit;t.xp6(2),t.Oqu(a.header),t.xp6(2),t.Q6J("ngIf",!a.field.includes("round")),t.xp6(1),t.Q6J("ngIf",a.field.includes("round")),t.xp6(1),t.Q6J("ngIf","action"===a.field)}}function St(e,n){if(1&e&&(t.TgZ(0,"tr"),t.YNc(1,xt,7,4,"td",13),t.qZA()),2&e){const a=t.oxw();t.xp6(1),t.Q6J("ngForOf",a.tableColumns)}}function $t(e,n){if(1&e){const a=t.EpF();t.TgZ(0,"p-sidebar",19),t.NdJ("visibleChange",function(i){t.CHM(a);const m=t.oxw();return t.KtG(m.display=i)}),t.TgZ(1,"cha-admin-draft-mgmt-table-edit",20),t.NdJ("closeSidebar",function(){t.CHM(a);const i=t.oxw();return t.KtG(i.onClose())}),t.qZA()()}if(2&e){const a=t.oxw();t.Q6J("visible",a.display)("fullScreen",!0)("showCloseIcon",!1)("dismissible",!1),t.xp6(1),t.Q6J("draftTableItem",a.draftTableItem)("isMobile",a.isMobile)}}const Zt=function(){return[10,20,25,50,100]},wt=function(){return["team"]};let Pt=(()=>{class e{constructor(a){this.leagueDataFacade=a,this.tableColumns=[{field:"id",header:"Pick Id"},{field:"draft_year",header:"Year"},{field:"team",header:"Team"},{field:"round_one",header:"Round 1"},{field:"round_two",header:"Round 2"},{field:"round_three",header:"Round 3"},{field:"round_four",header:"Round 4"},{field:"round_five",header:"Round 5"},{field:"action",header:"Edit"}],this.first=0,this.rows=20,this.totalRecords=0,this.sortField="full_name",this.display=!1,this.leagueDataFacade.leagueTeams$.pipe((0,L.P)()).subscribe(l=>this.teams=l)}ngOnInit(){this.draftTableItemsForTable=this.mapItems(this.draftTableItems)}applyFilterGlobal(a,l){this.dt?.filterGlobal(a.target.value,l)}mapItems(a){return a.map(l=>({...l,team:`${l.team_id.city} ${l.team_id.nickname}`}))}onClick(a){this.draftTableItem=a,this.display=!0}onClose(){this.display=!1,this.draftTableItem=null}getLogo(a){if(this.teams.length>0){const l=this.teams.find(i=>i.id===a)?.teamlogo;return l?this.getString(l):void 0}}getString(a){const l=a.split("/");return`assets/${l[l.length-1]}`}}return e.\u0275fac=function(a){return new(a||e)(t.Y36(v.Ib))},e.\u0275cmp=t.Xpm({type:e,selectors:[["cha-admin-draft-mgmt-table-table"]],viewQuery:function(a,l){if(1&a&&t.Gf(Dt,5),2&a){let i;t.iGM(i=t.CRH())&&(l.dt=i.first)}},inputs:{isMobile:"isMobile",draftTableItems:"draftTableItems"},decls:6,vars:15,consts:[["styleClass","p-datatable-sm p-datatable-striped","currentPageReportTemplate","Showing {first} to {last} of {totalRecords} entries",1,"table",3,"responsiveLayout","value","columns","rows","showCurrentPageReport","rowsPerPageOptions","paginator","totalRecords","sortField","sortOrder","filterDelay","globalFilterFields"],["dt",""],["pTemplate","caption"],["pTemplate","header"],["pTemplate","body"],[3,"visible","fullScreen","showCloseIcon","dismissible","visibleChange",4,"ngIf"],[1,"flex","flex-wrap","justify-content-between"],[1,"p-input-icon-left"],[1,"pi","pi-search"],["pInputText","","type","text","placeholder","Search Team",3,"input"],[3,"pSortableColumn",4,"ngFor","ngForOf"],[3,"pSortableColumn"],[3,"field"],[4,"ngFor","ngForOf"],[1,"p-column-title"],[1,"table-body-cell"],[4,"ngIf"],["height","30px",3,"src"],["pButton","","type","button","icon","pi pi-user-edit",1,"p-button-rounded","p-button-primary",3,"click"],[3,"visible","fullScreen","showCloseIcon","dismissible","visibleChange"],[3,"draftTableItem","isMobile","closeSidebar"]],template:function(a,l){1&a&&(t.TgZ(0,"p-table",0,1),t.YNc(2,Mt,4,0,"ng-template",2),t.YNc(3,Ft,2,1,"ng-template",3),t.YNc(4,St,2,1,"ng-template",4),t.qZA(),t.YNc(5,$t,2,6,"p-sidebar",5)),2&a&&(t.Q6J("responsiveLayout","stack")("value",l.draftTableItemsForTable)("columns",l.tableColumns)("rows",l.rows)("showCurrentPageReport",!0)("rowsPerPageOptions",t.DdM(13,Zt))("paginator",!0)("totalRecords",l.totalRecords)("sortField",l.sortField)("sortOrder",1)("filterDelay",0)("globalFilterFields",t.DdM(14,wt)),t.xp6(5),t.Q6J("ngIf",l.display))},dependencies:[f.sg,f.O5,h.iA,A.jx,h.lQ,h.fz,I.o,M.Hq,x.Y,c],encapsulation:2,changeDetection:0}),e})();const At=function(){return{height:"6px"}};function Rt(e,n){1&e&&t._UZ(0,"p-progressBar",5),2&e&&t.Akn(t.DdM(2,At))}function Jt(e,n){if(1&e&&(t.ynx(0),t._UZ(1,"cha-admin-draft-mgmt-table-table",6),t.BQk()),2&e){const a=n.ngIf,l=t.oxw(2);t.xp6(1),t.Q6J("draftTableItems",a)("isMobile",l.isMobile)}}function Lt(e,n){if(1&e&&(t.TgZ(0,"blade-card")(1,"blade-card-body"),t.YNc(2,Jt,2,2,"ng-container",4),t.ALo(3,"async"),t.qZA()()),2&e){const a=t.oxw();t.xp6(2),t.Q6J("ngIf",t.lcZ(3,1,a.draftTableItems$))}}const Ot=[{path:"",component:(()=>{class e{constructor(a,l){this.draftMgmtTableFacade=a,this.displayFacade=l,this.isLoaded$=this.draftMgmtTableFacade.isLoaded$,this.isLoading$=this.draftMgmtTableFacade.isLoading$,this.draftTableItems$=this.draftMgmtTableFacade.draftTableItems$,this.displayFacade.isMobile$.pipe((0,L.P)()).subscribe(i=>{this.isMobile=i})}ngOnInit(){this.draftMgmtTableFacade.getDraftTable()}}return e.\u0275fac=function(a){return new(a||e)(t.Y36(T),t.Y36(v.pC))},e.\u0275cmp=t.Xpm({type:e,selectors:[["cha-admin-draft-mgmt-table"]],decls:12,vars:6,consts:[["mode","indeterminate",3,"style",4,"ngIf"],[1,"pt-2"],[1,"text-lg","text-center",2,"font-weight","100"],[1,"text-sm","text-center",2,"font-weight","100"],[4,"ngIf"],["mode","indeterminate"],[3,"draftTableItems","isMobile"]],template:function(a,l){1&a&&(t.TgZ(0,"blade-layout-feature-content")(1,"div"),t.YNc(2,Rt,1,3,"p-progressBar",0),t.ALo(3,"async"),t.TgZ(4,"div",1)(5,"div",2),t._uU(6," Draft Table "),t.qZA(),t.TgZ(7,"div",3),t._uU(8," ** Updating this table is usually done through the transactions, this is for manual updates if needed ** "),t.qZA()(),t._UZ(9,"blade-divider"),t.YNc(10,Lt,4,3,"blade-card",4),t.ALo(11,"async"),t.qZA()()),2&a&&(t.xp6(2),t.Q6J("ngIf",t.lcZ(3,2,l.isLoading$)),t.xp6(8),t.Q6J("ngIf",t.lcZ(11,4,l.isLoaded$)))},dependencies:[f.O5,_.k,ut.R,O.A,Q.y,S.C,Pt,f.Ov],encapsulation:2,changeDetection:0}),e})()}];let Qt=(()=>{class e{}return e.\u0275fac=function(a){return new(a||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[J.Bz.forChild(Ot),J.Bz]}),e})();var Et=o(8173),Gt=o(5621),Nt=o(7240);let Ut=(()=>{class e{}return e.\u0275fac=function(a){return new(a||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({providers:[R,T],imports:[f.ez,p.UX,C.Xd,_.q,h.U$,I.j,M.hJ,x.l,B.E,H.N,S.C,Qt,r.Aw.forFeature("draft-mgmt-table",et),d.sQ.forFeature([R]),N.X0.forRoot({wrappers:[{name:"control-wrapper",component:Nt.t}],types:[{name:"text-input",component:Gt.T,wrappers:["control-wrapper"]},{name:"single-select",component:Et.S,wrappers:["control-wrapper"]}]})]}),e})()}}]);